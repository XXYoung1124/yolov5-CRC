# YOLOv5 ğŸš€ by Ultralytics, GPL-3.0 license

# Parameters
nc: 80  # number of classes  ç±»åˆ«ç§ç±»
depth_multiple: 1.0  # model depth multiple    æ§åˆ¶æ¨¡å‹å¤§å°
width_multiple: 1.0  # layer channel multiple  æ§åˆ¶æ¨¡å‹å¤§å°
anchors: #å€™é€‰æ¡†å¤§å°
  - [10,13, 16,30, 33,23]  # P3/8  å°ç›®æ ‡æ£€æµ‹
  - [30,61, 62,45, 59,119]  # P4/16
  - [116,90, 156,198, 373,326]  # P5/32  å¤§ç›®æ ‡æ£€æµ‹

# YOLOv5 v6.0 backbone
backbone:
  # [from, number, module, args]
  # from:-1ä»£è¡¨ä¸Šä¸€å±‚è¾“å‡ºå½“ä½œè¿™ä¸€å±‚è¾“å…¥
  # number:layeré‡å¤æ¬¡æ•°  å®é™…è¦ä¹˜ä»¥depth_multiple
  # module:æ¯å±‚layeråå­—
  # args:è¾“å‡ºé€šé“æ•° å®é™…è¦ä¹˜ä»¥width_multiple  å·ç§¯æ ¸å¤§å°  padå¤§å°  strå¤§å°

  #640*640*3è¾“å…¥

# 0   P1/2  K6 S2 P2 C64 320*320*64
  [[-1, 1, Conv, [64, 6, 2, 2]],

# 1 2  P2/4    K3 S2 P1 C128  160*160*128
   [-1, 1, Conv, [128, 3, 2]],
   [-1, 3, C3, [128]],

# 3 4  P3/8    K3 S2 P1 C256  80*80*256
   [-1, 1, Conv, [256, 3, 2]],
   [-1, 6, C3, [256]],

# 5 6  P4/16   K3 S2 P1 C512  40*40*512
   [-1, 1, Conv, [512, 3, 2]],
   [-1, 9, C3, [512]],

# 7 8  P5/32  K3 S2 P1 C1024  20*20*1024
   [-1, 1, Conv, [1024, 3, 2]],
   [-1, 3, C3, [1024]],

# 9   20*20*1024
   [-1, 1, SPPF, [1024, 5]],
  ]

# YOLOv5 v6.0 head

head:
#  20*20*1024ï¼ˆä¸Šï¼‰
  [[-1, 1, Conv, [512, 1, 1]],                    #10 K1 S1 P0 C512  20*20*512
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],    #11 40*40*512
   [[-1, 6], 1, Concat, [1]],                     #12-------cat-6-40*40*512-----------
   [-1, 3, C3, [512, False]],                     #13 40*40*512

   [-1, 1, Conv, [256, 1, 1]],                    #14 K1 S1 P0 C256  40*40*256
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],    #15 80*80*256
   [[-1, 4], 1, Concat, [1]],                     #16-------cat 4 80*80*256------------
   [-1, 3, C3, [256, False]],                     #17(P3/8-small) 80*80*256


#ï¼ˆä¸‹ï¼‰
   [-1, 1, Conv, [256, 3, 2]],                    #18 k3 s2 p1 c256  40*40*256
   [[-1, 14], 1, Concat, [1]],                    #19-------cat-14-40*40*256-------
   [-1, 3, C3, [512, False]],                     #20 (P4/16-medium)40*40*512

   [-1, 1, Conv, [512, 3, 2]],                    #21 k3 s2 p1 c512   20*20*512
   [[-1, 10], 1, Concat, [1]],                    #22-------cat--10-20*20*512-------
   [-1, 3, C3, [1024, False]],                    #23 (P5/32-large)20*20*1024



   [[17, 20, 23], 1, Detect, [nc, anchors]],      # Detect(P3, P4, P5)
  ]
